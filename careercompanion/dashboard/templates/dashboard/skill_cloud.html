{% extends 'dashboard/base.html' %}
{% load static %}
{% block content %}

<div class="skill-header">
  <h2>Skill Cloud</h2>
  <input type="text" id="skillSearch" placeholder="Search skills...">
</div>

{% if total_count == 0 %}
  <div class="no-skills">
    <p>No skills to show. Please update your profile to add skills.</p>
    <a href="{% url 'complete_profile' %}" class="update-btn">Go to Complete Profile</a>
  </div>
{% else %}
  {% for category, items in categorized_skills.items %}
    {% if items %}
      <div class="category-block">
        <h3>{{ category }}</h3>
        <div class="skill-cloud">
          {% for skill, count in items %}
            <div class="cloud"
                 data-skill="{{ skill|lower }}"
                 style="font-size: {{ 12|add:count|floatformat:0 }}px;">
              {{ skill|title }}
              {% for key, icon in skill_icons.items %}
                {% if key in skill|lower %}
                  <img src="{{ icon }}" alt="{{ skill }} logo" class="skill-icon">
                {% endif %}
              {% endfor %}
            </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}
  {% endfor %}
{% endif %}

<style>
/* header */
.skill-header { text-align: center; margin-bottom: 25px; }
.skill-header h2 { font-size: 2rem; font-weight: 700; margin-bottom: 12px; }
.skill-header input {
  padding: 10px 15px; width: 320px; max-width: 90%;
  border: 2px solid #ccc; border-radius: 8px; font-size: 16px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}
.skill-header input:focus { outline: none; border-color: #3b82f6; }

/* category */
.category-block { margin: 28px 0; }
.category-block h3 { margin-bottom: 12px; font-size: 1.2rem; color: #444; }

/* cloud */
.skill-cloud {
  display: flex; flex-wrap: wrap; gap: 16px; padding: 16px;
  background: linear-gradient(to bottom, #e0f7fa, #f1f8ff);
  border-radius: 16px; box-shadow: inset 0 4px 8px rgba(0,0,0,0.05);
  justify-content: center;
}
.cloud {
  position: relative; background: #fff; padding: 12px 20px; border-radius: 50px;
  box-shadow: 0 6px 12px rgba(0,0,0,0.15); font-weight: 600; color: #333;
  transition: transform .25s ease, background .25s ease; overflow: hidden; cursor: pointer;
}
.skill-icon {
  position: absolute; width: 44px; height: 44px; bottom: -12px; right: -12px;
  opacity: 0; transform: scale(.5); transition: opacity .3s ease, transform .3s ease;
}
.cloud:hover .skill-icon { opacity: .6; transform: scale(1); }
.cloud:hover { background: #3b82f6; color: #fff; transform: scale(1.08); }

/* empty state */
.no-skills { text-align: center; margin: 40px auto; font-size: 1.1rem; color: #555; }
.update-btn {
  display: inline-block; margin-top: 14px; padding: 10px 18px; background: #3b82f6;
  color: white; border-radius: 8px; text-decoration: none; font-weight: 600;
}
.update-btn:hover { background: #2563eb; }
</style>

<script>
/* live search across all categories */
document.getElementById("skillSearch").addEventListener("input", function () {
  const q = this.value.toLowerCase();
  document.querySelectorAll(".cloud").forEach(el => {
    const val = el.getAttribute("data-skill") || "";
    el.style.display = val.includes(q) ? "inline-flex" : "none";
  });
});
</script>
{% endblock %}
